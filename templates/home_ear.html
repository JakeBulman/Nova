{% extends 'base.html' %}

{% block content %}
{% load static %}

<h3 class="mt-3 mx-4 my-1">My Tasks</h3>

<div class="row mx-2">

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/search-icon.png' %}" alt="Search Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Enquiry Search</h5>
      <p class="card-text">Search for specific enquiry numbers.</p>
      <form class="row g-3  d-grid" method="POST" action='/enquiries/enquiries_detail_search'>
        <div class="col-auto">
          <input name="enquiry_id" id="enquiry_id" type="text" class="form-control" placeholder="Enquiry No.">
        </div>
        <button type="submit" class="btn btn-outline-primary">Search</button>
      </form>
    </div>
  </div>

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/mytask-icon.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">My Tasks</h5>
      {% if mytask.count > 0 %}<span class="badge rounded-pill bg-danger">{{ mytask.count }} Tasks Assigned To Me</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      <p class="card-text">A list of tasks currently assigned to me.</p>
      <a href="{% url 'my_tasks' %}" class="mt-auto btn btn-outline-primary">Go to My Tasks</a>
    </div>
  </div>
  

</div>

<h3 class="mx-4 my-1">Batch Tasks</h3>

<div class="row mx-2">

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/exm-avail-icon.png' %}" alt="Examiner availability Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Examiner Setup</h5>
      <span class="badge rounded-pill bg-success"></span>
      <p class="card-text">Add and change the availability windows for examiners.</p>
      <a href="{% url 'examiner_list' %}" class="mt-auto btn btn-outline-primary">Go to Examiners</a>
    </div>
  </div>

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/iec-icon.png' %}" alt="IEC Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Initial Enquiry Checks</h5>
      {% if cer.count > 0 %}<span class="badge rounded-pill bg-danger">{{ cer.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      <p class="card-text">Checks on new enquiries to confirm availability to proceed to apportionment.</p>
      <a href="{% url 'enquiries_list' %}" class="mt-auto btn btn-outline-primary">Go to IECs</a>
    </div>
  </div>

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/iec-icon.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">ESM CSV Download</h5>
      {% if esmcsv.count > 0 %}<span class="badge rounded-pill bg-danger">{{ esmcsv.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      <p class="card-text">Download for examiner access to RM</p>
      <a href="{% url 'esmcsv_list' %}" class="mt-auto btn btn-outline-primary">Download File</a>
    </div>
  </div>
</div>



<h3 class="mx-4 my-1">Listed Tasks</h3>

<div class="row mx-2">

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/bie-icon.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">BIE Tasks</h5>
      {% if bie.count > 0 %}<span class="badge rounded-pill bg-danger">{{ bie.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      {% if biea.count > 0 %}<span class="badge rounded-pill bg-warning mt-1">{{ biea.count }} Tasks Assigned</span>{% else %}<span class="badge rounded-pill bg-success mt-1">No Tasks Assigned</span>{% endif %}
      <p class="card-text">Convert WebApp cancellations to EPS BIE status</p>
      <a href="{% url 'enquiries_setbie_list' %}" class="mt-auto btn btn-outline-primary">Go to BIE Tasks</a>
    </div>
  </div>
  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Previous Examiner Checks</h5>
      {% if pexmch.count > 0 %}<span class="badge rounded-pill bg-danger">{{ pexmch.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      {% if pexmcha.count > 0 %}<span class="badge rounded-pill bg-warning mt-1">{{ pexmcha.count }} Tasks Assigned</span>{% else %}<span class="badge rounded-pill bg-success mt-1">No Tasks Assigned</span>{% endif %}
      <p class="card-text">Checks on previous examiners when a GR or TL Adjustment has taken place.</p>
      <a href="{% url 'pexmch_list' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
    </div>
  </div>
  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Manual Apportionment</h5>
      {% if manapp.count > 0 %}<span class="badge rounded-pill bg-danger">{{ manapp.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      {% if manappa.count > 0 %}<span class="badge rounded-pill bg-warning mt-1">{{ manappa.count }} Tasks Assigned</span>{% else %}<span class="badge rounded-pill bg-success mt-1">No Tasks Assigned</span>{% endif %}
      <p class="card-text">Scripts awaiting manual apportionment.</p>
      <a href="{% url 'manapp_list' %}" class="mt-auto btn btn-outline-primary">Go to Apportionment</a>
    </div>
  </div>
  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">MIS RM Checks</h5>
      {% if misvrm.count > 0 %}<span class="badge rounded-pill bg-danger">{{ misvrm.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      {% if misvrma.count > 0 %}<span class="badge rounded-pill bg-warning mt-1">{{ misvrma.count }} Tasks Assigned</span>{% else %}<span class="badge rounded-pill bg-success mt-1">No Tasks Assigned</span>{% endif %}
      <p class="card-text">Checks between returned MIS forms and RM.</p>
      <a href="{% url 'misvrm_list' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
    </div>
  </div>
  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">Examiner SLA Breaches</h5>
      {% if exmsla.count > 0 %}<span class="badge rounded-pill bg-danger">{{ exmsla.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      {% if exmslaa.count > 0 %}<span class="badge rounded-pill bg-warning mt-1">{{ exmslaa.count }} Tasks Assigned</span>{% else %}<span class="badge rounded-pill bg-success mt-1">No Tasks Assigned</span>{% endif %}
      <p class="card-text">Checks on examiner breaches leading to extension of reapportionment.</p>
      <a href="{% url 'exmsla_list' %}" class="mt-auto btn btn-outline-primary">Go to Breaches</a>
    </div>
  </div>
</div>



<h3 class="mx-4 my-1">RPA Tasks</h3>

<div class="row mx-2">

    <div class="card m-3 shadow-lg" style="width: 18rem; ">
        <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
        <div class="card-body d-flex flex-column">
          <h5 class="card-title">RPA Apportionment</h5>
          {% if botapp.count > 0 %}<span class="badge rounded-pill bg-danger">{{ botapp.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
          <p class="card-text">Tasks awaiting an RPA processing run for apportionment.</p>
          <a href="{% url 'rpa_apportionment' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
        </div>
      </div>
  
    <div class="card m-3 shadow-lg" style="width: 18rem; ">
      <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">RPA Apportion Failures</h5>
        {% if botapf.count > 0 %}<span class="badge rounded-pill bg-danger">{{ botapf.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
        <p class="card-text">Tasks awaiting completion after a bot failed to process an apportionment.</p>
        <a href="{% url 'rpa_apportionment_failure' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
      </div>
    </div>

    <div class="card m-3 shadow-lg" style="width: 18rem; ">
      <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
      <div class="card-body d-flex flex-column">
        <h5 class="card-title">RPA Marks Keying</h5>
        {% if botmar.count > 0 %}<span class="badge rounded-pill bg-danger">{{ botmar.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
        <p class="card-text">Tasks awaiting an RPA processing run for marks keying.</p>
        <a href="{% url 'rpa_marks_keying' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
      </div>
    </div>

  <div class="card m-3 shadow-lg" style="width: 18rem; ">
    <img class="card-img-top" src="{% static 'admin/img/placeholder-image.png' %}" alt="EAR Icon">
    <div class="card-body d-flex flex-column">
      <h5 class="card-title">RPA Marks Keying Failures</h5>
      {% if botmaf.count > 0 %}<span class="badge rounded-pill bg-danger">{{ botmaf.count }} Tasks Waiting</span>{% else %}<span class="badge rounded-pill bg-success">All Tasks Completed</span>{% endif %}
      <p class="card-text">Tasks awaiting completion after a bot failed to process a mark keying.</p>
      <a href="{% url 'rpa_marks_keying_failure' %}" class="mt-auto btn btn-outline-primary">Go to Checks</a>
    </div>
  </div>
</div>

{% endblock %}
