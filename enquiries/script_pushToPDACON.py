from openpyxl import load_workbook
import sys
import os
import django
from django.utils import timezone

if os.getenv('DJANGO_DEVELOPMENT') == 'true':
    print('DEV')
    path = os.path.join('C:\\Users\\bulmaj\\OneDrive - Cambridge\\Desktop\\Dev\\Nova')
    sys.path.append(path)
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings_dev'
elif os.getenv('DJANGO_PRODUCTION') == 'true':
    print('PROD')
    path = os.path.join('C:\\Dev\\Nova')
    sys.path.append(path)
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings_prod'
else:
    print('UAT - Check')
    path = os.path.join('C:\\Dev\\nova')
    sys.path.append(path)
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings'

django.setup()

from enquiries.models import TaskManager, RpaFailureAudit, ScriptApportionment, EnquiryComponentElements, CentreEnquiryRequests, EnquiryComponents, EnquiryComponentsHistory, TaskTypes, ScaledMarks,GradeFailureAudit
from django.contrib.auth.models import User

ec_list = [
    '1318140',
'1318184',
'1318326',
'1318342',
'1318348',
'1318350',
'1318272',
'1318280',
'1318308',
'1333142',
'1333156',
'1323556',
'1339826',
'1339658',
'1339654',
'1339744',
'1323450',
'1323460',
'1323474',
'1323482',
'1323502',
'1323504',
'1323508',
'1323540',
'1324758',
'1324760',
'1324774',
'1324784',
'1319856',
'1321362',
'1324798',
'1324828',
'1324858',
'1322926',
'1322932',
'1322916',
'1322998',
'1341788',
'1342010',
'1342678',
'1343038',
'1343728',
'1343710',
'1343714',
'1343718',
'1343720',
'1343724',
'1343734',
'1328016',
'1343748',
'1343746',
'1343908',
'1344534',
'1344606',
'1344644',
'1344658',
'1344662',
'1344756',
'1344724',
'1344750',
'1344764',
'1332920',
'1318808',
'1318862',
'1318452',
'1318538',
'1318408',
'1318574',
'1318624',
'1318540',
'1318546',
'1318796',
'1318750',
'1318748',
'1318420',
'1318680',
'1318758',
'1318438',
'1318440',
'1318900',
'1318902',
'1318598',
'1318770',
'1318468',
'1318604',
'1318872',
'1318652',
'1318480',
'1318516',
'1318836',
'1318518',
'1318746',
'1318352',
'1318620',
'1318532',
'1324734',
'1324752',
'1334340',
'1334174',
'1334218',
'1334238',
'1334240',
'1334278',
'1334304',
'1334420',
'1332964',
'1332978',
'1333022',
'1333032',
'1332966',
'1333044',
'1333082',
'1323570',
'1323586',
'1323610',
'1323624',
'1323636',
'1323642',
'1323654',
'1323720',
'1323732',
'1323742',
'1323744',
'1323750',
'1323752',
'1323754',
'1323800',
'1323804',
'1323828',
'1323842',
'1323856',
'1323870',
'1323872',
'1323890',
'1323894',
'1323898',
'1323922',
'1323954',
'1323976',
'1323990',
'1323996',
'1324004',
'1324010',
'1324026',
'1324032',
'1324038',
'1324040',
'1324044',
'1324092',
'1324098',
'1324104',
'1324120',
'1324144',
'1324152',
'1324164',
'1324218',
'1324244',
'1324260',
'1324296',
'1324314',
'1324318',
'1324328',
'1324332',
'1324354',
'1324364',
'1324376',
'1324394',
'1324396',
'1324400',
'1324412',
'1324454',
'1324482',
'1324502',
'1324516',
'1324554',
'1324556',
'1324602',
'1324604',
'1324608',
'1324610',
'1324616',
'1324618',
'1324636',
'1324624',
'1324644',
'1324668',
'1324670',
'1324674',
'1324692',
'1324714',
'1324726',
'1324728',
'1324730',
'1324732',
'1324874',
'1324872',
'1320496',
'1320506',
'1320586',
'1320658',
'1320606',
'1320608',
'1320614',
'1320682',
'1320794',
'1320706',
'1320710',
'1320810',
'1320744',
'1320844',
'1320850',
'1320892',
'1320934',
'1320954',
'1320958',
'1321050',
'1321010',
'1320974',
'1320984',
'1320988',
'1320992',
'1320994',
'1321002',
'1321052',
'1321036',
'1321078',
'1321094',
'1321102',
'1321140',
'1321112',
'1321132',
'1321136',
'1321158',
'1321228',
'1321204',
'1321222',
'1321224',
'1321236',
'1321240',
'1321280',
'1321302',
'1321374',
'1321380',
'1321390',
'1321450',
'1321498',
'1321504',
'1321528',
'1319914',
'1320152',
'1319748',
'1319140',
'1320024',
'1319148',
'1319916',
'1319526',
'1319308',
'1319152',
'1318952',
'1320026',
'1319528',
'1320156',
'1320162',
'1318958',
'1319770',
'1320256',
'1320352',
'1320282',
'1320030',
'1318988',
'1319944',
'1319780',
'1319004',
'1319006',
'1320264',
'1319572',
'1319356',
'1319016',
'1319022',
'1319962',
'1319026',
'1319802',
'1319574',
'1319968',
'1319034',
'1319368',
'1320104',
'1318908',
'1319820',
'1319826',
'1319984',
'1319384',
'1319386',
'1320188',
'1319836',
'1319210',
'1319054',
'1319396',
'1319998',
'1318912',
'1319704',
'1319094',
'1319710',
'1320224',
'1320066',
'1319718',
'1319884',
'1319454',
'1319256',
'1320434',
'1321582',
'1321592',
'1321562',
'1321566',
'1321594',
'1321608',
'1321622',
'1321632',
'1321654',
'1321650',
'1321660',
'1321692',
'1321784',
'1321786',
'1321788',
'1321772',
'1321796',
'1321798',
'1321822',
'1321854',
'1321848',
'1321902',
'1321908',
'1321946',
'1321964',
'1321970',
'1322010',
'1322014',
'1322044',
'1322046',
'1322058',
'1322062',
'1322064',
'1322074',
'1322078',
'1322108',
'1322190',
'1322138',
'1322170',
'1322172',
'1322176',
'1322194',
'1322196',
'1322230',
'1322232',
'1322270',
'1322272',
'1322276',
'1322282',
'1322318',
'1322352',
'1322372',
'1322532',
'1322588',
'1322388',
'1322590',
'1322398',
'1322548',
'1322412',
'1322554',
'1322434',
'1322446',
'1322492',
'1322526',
'1322642',
'1322656',
'1322696',
'1322752',
'1322804',
'1322754',
'1322762',
'1322774',
'1322770',
'1322822',
'1319794',
'1322828',
'1322896',
'1322962',
'1322978',
'1322982',
'1322986',
'1322988',
'1323024',
'1320896',
'1323082',
'1323076',
'1323086',
'1323102',
'1323114',
'1323158',
'1323170',
'1323218',
'1323222',
'1323294',
'1323340',
'1333162',
'1333240',
'1333216',
'1333218',
'1333260',
'1333292',
'1333310',
'1333336',
'1333350',
'1333356',
'1333358',
'1333364',
'1333366',
'1333430',
'1333464',
'1333566',
'1333534',
'1333586',
'1333626',
'1333646',
'1333642',
'1333748',
'1333698',
'1333716',
'1333744',
'1333834',
'1333856',
'1333858',
'1333870',
'1319546',
'1333298',
'1333914',
'1333918',
'1333926',
'1333924',
'1333880',
'1333906',
'1334000',
'1334048',
'1334066',
'1334114',
'1334110',
'1325162',
'1325180',
'1325184',
'1325232',
'1325236',
'1325240',
'1325282',
'1325286',
'1325354',
'1325322',
'1325390',
'1325396',
'1325484',
'1325458',
'1325460',
'1325462',
'1325464',
'1325514',
'1325504',
'1325510',
'1325516',
'1325550',
'1325552',
'1325580',
'1325648',
'1325642',
'1325678',
'1325682',
'1326226',
'1325708',
'1325766',
'1325732',
'1325740',
'1325748',
'1325810',
'1325826',
'1325828',
'1325858',
'1324014',
'1325884',
'1325908',
'1325922',
'1325936',
'1326274',
'1325944',
'1325948',
'1325966',
'1325968',
'1325976',
'1326276',
'1326320',
'1326662',
'1326844',
'1326770',
'1326796',
'1326806',
'1326812',
'1326824',
'1326876',
'1326878',
'1326928',
'1326556',
'1326572',
'1326574',
'1326584',
'1326444',
'1326618',
'1326446',
'1326448',
'1326428',
'1322848',
'1326968',
'1326982',
'1326998',
'1327006',
'1327008',
'1327026',
'1327030',
'1327034',
'1326456',
'1326468',
'1327022',
'1326074',
'1326080',
'1324882',
'1324984',
'1325078',
'1325058',
'1326124',
'1326150',
'1326200',
'1325038',
'1324920',
'1324942',
'1325010',
'1326512',
'1326516',
'1326204',
'1326384',
'1326694',
'1326696',
'1325088',
'1326222',
'1326532',
'1325092',
'1325106',
'1324950',
'1325110',
'1324952',
'1324954',
'1325508',
'1325614',
'1327048',
'1327056',
'1327086',
'1327094',
'1327102',
'1327134',
'1327200',
'1327226',
'1327238',
'1327266',
'1327270',
'1327276',
'1327288',
'1327296',
'1327312',
'1327314',
'1327332',
'1327370',
'1327374',
'1327380',
'1327388',
'1327414',
'1327460',
'1327476',
'1327482',
'1327502',
'1327510',
'1327532',
'1327554',
'1327556',
'1327558',
'1327572',
'1327618',
'1327632',
'1327644',
'1327658',
'1327672',
'1327698',
'1322742',
'1327708',
'1329980',
'1322068',
'1335234',
'1335882',
'1335282',
'1335312',
'1335320',
'1335376',
'1337350',
'1337806',
'1334900',
'1334904',
'1334908',
'1334914',
'1334922',
'1334932',
'1334930',
'1334940',
'1334942',
'1334968',
'1335020',
'1335042',
'1335060',
'1335062',
'1335760',
'1335984',
'1335220',
'1335226',
'1335228',
'1335230',
'1335232',
'1335400',
'1335430',
'1335466',
'1335474',
'1335442',
'1335444',
'1335994',
'1335790',
'1335554',
'1334470',
'1334476',
'1335996',
'1336116',
'1335584',
'1336008',
'1335894',
'1335604',
'1335808',
'1336790',
'1336794',
'1335622',
'1337470',
'1337474',
'1336408',
'1337498',
'1337500',
'1336028',
'1334560',
'1337156',
'1337432',
'1337680',
'1329252',
'1337796',
'1337860',
'1334570',
'1336986',
'1337554',
'1337696',
'1336414',
'1336820',
'1337364',
'1337534',
'1336476',
'1335812',
'1337356',
'1337360',
'1336656',
'1337502',
'1335646',
'1337240',
'1337000',
'1337004',
'1337006',
'1337750',
'1336484',
'1336486',
'1334658',
'1336040',
'1337180',
'1336856',
'1337570',
'1337568',
'1337706',
'1334670',
'1334674',
'1334650',
'1336684',
'1337186',
'1337022',
'1337026',
'1337652',
'1337814',
'1336348',
'1336500',
'1334756',
'1336678',
'1335918',
'1335920',
'1336424',
'1319156',
'1323684',
'1325248',
'1326722',
'1337526',
'1337836',
'1334776',
'1337482',
'1334678',
'1334680',
'1329302',
'1334772',
'1335728',
'1335696',
'1336240',
'1336516',
'1337774',
'1334682',
'1328086',
'1328088',
'1328090',
'1328100',
'1334782',
'1334794',
'1334786',
'1328112',
'1328114',
'1329878',
'1329914',
'1329916',
'1330456',
'1322392',
'1327738',
'1327722',
'1327742',
'1327784',
'1327818',
'1327834',
'1327872',
'1327880',
'1327932',
'1327886',
'1327898',
'1327926',
'1327950',
'1328018',
'1318616',
'1324028',
'1328038',
'1319832',
'1318444',
'1328074',
'1328076',
'1328082',
'1328116',
'1328168',
'1328176',
'1328180',
'1328196',
'1328202',
'1328244',
'1328250',
'1328418',
'1328252',
'1328256',
'1328260',
'1328304',
'1328314',
'1328320',
'1328326',
'1328332',
'1328340',
'1328344',
'1328372',
'1328386',
'1328388',
'1328434',
'1328454',
'1328510',
'1328568',
'1328600',
'1328728',
'1328738',
'1328744',
'1328746',
'1328764',
'1328788',
'1328948',
'1328826',
'1328830',
'1328832',
'1328856',
'1328890',
'1328912',
'1328922',
'1328926',
'1328974',
'1328996',
'1329002',
'1329016',
'1329024',
'1329036',
'1329060',
'1329074',
'1329086',
'1329116',
'1329134',
'1329170',
'1329190',
'1329192',
'1329198',
'1329242',
'1329308',
'1329398',
'1329362',
'1329368',
'1329386',
'1329452',
'1329466',
'1329482',
'1329500',
'1329506',
'1329508',
'1329514',
'1329518',
'1329588',
'1329618',
'1329642',
'1329652',
'1329658',
'1329666',
'1329668',
'1330194',
'1330406',
'1330414',
'1330440',
'1330442',
'1330448',
'1329700',
'1329710',
'1329712',
'1329718',
'1329724',
'1329734',
'1329740',
'1329848',
'1329850',
'1329866',
'1329920',
'1329926',
'1329950',
'1329958',
'1329998',
'1330066',
'1330070',
'1330116',
'1330130',
'1330132',
'1330266',
'1330270',
'1330292',
'1330326',
'1330334',
'1330344',
'1330364',
'1330376',
'1330378',
'1330472',
'1330480',
'1330502',
'1330510',
'1330560',
'1330574',
'1330604',
'1330638',
'1330682',
'1330842',
'1330724',
'1330758',
'1330764',
'1330820',
'1330846',
'1330862',
'1330874',
'1330880',
'1330882',
'1330898',
'1330902',
'1330944',
'1330964',
'1330982',
'1330988',
'1330996',
'1331014',
'1331018',
'1331022',
'1331026',
'1331076',
'1331124',
'1331130',
'1331132',
'1331134',
'1331144',
'1331208',
'1331328',
'1331362',
'1331426',
'1331364',
'1331434',
'1331442',
'1331406',
'1331416',
'1331446',
'1331472',
'1331496',
'1331636',
'1331632',
'1331668',
'1331670',
'1331688',
'1331692',
'1331708',
'1331716',
'1331732',
'1331746',
'1331752',
'1331756',
'1331758',
'1331764',
'1331776',
'1331790',
'1331800',
'1331814',
'1331830',
'1331828',
'1331902',
'1331934',
'1331950',
'1331978',
'1332012',
'1332034',
'1332110',
'1332100',
'1332130',
'1332244',
'1332272',
'1332298',
'1332284',
'1332292',
'1332302',
'1332336',
'1332340',
'1332382',
'1332396',
'1332398',
'1332408',
'1332416',
'1332488',
'1332492',
'1332520',
'1332524',
'1332532',
'1332558',
'1332594',
'1332600',
'1332616',
'1332622',
'1332650',
'1332688',
'1332696',
'1332706',
'1332742',
'1332782',
'1332784',
'1332824',
'1332844',
'1332878',
'1332882',
'1332898',
'1336442',
'1334722',
'1334810',
'1335924',
'1336716',
'1337208',
'1336924',
'1337328',
'1335848',
'1337634',
'1334736',
'1335930',
'1335718',
'1336718',
'1336720',
'1334816',
'1335738',
'1336210',
'1335946',
'1334836',
'1336928',
'1335854',
'1336552',
'1334484',
'1337546',
'1337802',
'1337216',
'1336560',
'1335952',
'1337266',
'1336568',
'1337342',
'1337340',
'1336950',
'1335958',
'1334868',
'1337220',
'1337742',
'1336454',
'1337120',
'1337816',
'1336590',
'1336958',
'1336772',
'1336774',
'1337548',
'1335744',
'1335964',
'1337638',
'1334878',
'1337130',
'1336598',
'1337606',
'1336966',
'1327144',
'1338594',
'1337964',
'1338612',
'1338810',
'1337976',
'1339054',
'1337990',
'1329972',
'1329624',
'1328070',
'1339064',
'1339262',
'1339332',
'1327790',
'1338356',
'1338988',
'1338646',
'1331052',
'1338010',
'1336714',
'1338660',
'1337784',
'1339074',
'1338048',
'1338024',
'1339512',
'1338062',
'1338676',
'1338386',
'1338696',
'1338078',
'1338102',
'1338710',
'1338712',
'1338118',
'1339382',
'1338126',
'1339470',
'1338140',
'1338134',
'1338896',
'1338142',
'1339290',
'1339142',
'1336798',
'1339390',
'1339392',
'1339006',
'1339152',
'1338904',
'1338164',
'1334610',
'1339516',
'1338462',
'1338178',
'1338474',
'1339300',
'1337878',
'1338200',
'1339040',
'1338492',
'1339398',
'1339444',
'1339090',
'1338216',
'1339406',
'1336732',
'1339180',
'1339252',
'1338228',
'1338506',
'1338516',
'1338520',
'1338786',
'1338258',
'1337908',
'1327402',
'1328858',
'1327964',
'1338290',
'1339668',
'1339606',
'1339670',
'1339682',
'1339690',
'1339694',
'1339702',
'1339892',
'1339788',
'1339796',
'1339708',
'1339642',
'1339808',
'1339818',
'1340644',
'1340666',
'1341080',
'1341082',
'1341096',
'1341118',
'1341132',
'1343012',
'1341136',
'1341140',
'1341432',
'1344192',
'1340158',
'1340620',
'1340632',
'1340180',
'1340556',
'1340664',
'1340668',
'1340580',
'1340816',
'1340874',
'1340708',
'1340954',
'1340956',
'1340294',
'1340210',
'1340714',
'1340726',
'1340828',
'1340918',
'1340222',
'1340226',
'1341028',
'1340312',
'1340374',
'1340888',
'1340382',
'1340390',
'1340392',
'1340398',
'1340396',
'1340408',
'1340410',
'1339958',
'1340446',
'1340474',
'1340486',
'1340476',
'1340024',
'1340070',
'1340500',
'1340504',
'1340046',
'1340066',
'1340118',
'1341206',
'1340530',
'1341182',
'1341184',
'1341228',
'1341232',
'1341250',
'1341258',
'1341262',
'1341178',
'1341350',
'1341360',
'1341378',
'1341414',
'1341436',
'1341440',
'1341376',
'1341554',
'1341606',
'1341580',
'1341680',
'1341688',
'1341736',
'1341826',
'1341860',
'1341986',
'1341948',
'1341952',
'1341972',
'1342024',
'1342026',
'1342056',
'1342156',
'1342180',
'1342182',
'1342184',
'1342138',
'1342204',
'1342210',
'1342176',
'1342244',
'1342298',
'1342450',
'1342768',
'1342710',
'1342790',
'1342784',
'1342882',
'1342996',
'1343048',
'1343080',
'1343100',
'1343118',
'1343128',
'1343406',
'1343790',
'1343810',
'1343818',
'1343828',
'1343830',
'1343934',
'1343972',
'1337354',
'1344014',
'1344086',
'1344036',
'1344054',
'1344070',
'1344078',
'1344156',
'1344180',
'1344196',
'1344272',
'1344208',
'1344218',
'1344290',
'1344300',
'1344332',
'1344334',
'1344366',
'1344390',
'1344370',
'1344398',
'1344406',
'1344410',
'1344474',
'1344416',
'1344426',
'1344520',
'1344486',
'1343130',
'1343138',
'1343162',
'1343220',
'1343226',
'1343246',
'1343316',
'1343276',
'1343288',
'1343306',
'1343328',
'1343368',
'1343384',
'1343400',
'1343424',
'1343450',
'1343452',
'1343460',
'1343462',
'1343518',
'1343500',
'1343504',
'1343536',
'1343566',
'1343584',
'1343604',
'1343622',
'1343638',
'1343680',
'1343704',
'1333308',
'1343948',
'1324652',
'1328398',
'1344848',
'1344886',
'1345014',
'1345028',
'1345158',
'1345164',
'1345214',
'1345232',
'1345260',
'1345262',
'1345288',
'1345304',
'1345306',
'1345314',
'1345368',
'1345360',
'1345380',
'1345386',
'1345414',
'1345404',
'1345468',
'1345580',
'1345512',
'1345524',
'1345592',
'1345624',
'1345634',
'1345636',
'1345654',
'1345664',
'1345690',
'1345702',
'1345704',
'1345706',
'1345710',
'1345712',
'1345716',
'1345724',
'1345728',
'1334848',
'1345778',
'1345788',
'1345868',
'1345900',
'1345908',
'1345932',
'1345952',
'1345982',
'1346006',
'1346010',
'1346058',
'1346018',
'1346020',
'1332984',
'1346056',
'1346106',
'1346110',
'1346122',
'1346196',
'1346138',
'1333828',
'1346168',
'1346176',
'1346188',
'1346260',
'1346312',
'1346268',
'1346332',
'1330042',
'1346350',
'1345976',
'1349198',
'1349202',
'1349216',
'1349086',
'1349064',
'1349068',
'1349074',
'1345718',
'1354126',
'1354134',
'1352258',
'1349104',
'1353366',
'1349180',
'1349156',
'1352306',
'1349190',
'1349238',
'1349248',
'1349276',
'1349300',
'1349306',
'1349352',
'1353416',
'1353938',
'1354312',
'1349388',
'1352368',
'1352424',
'1353944',
'1353956',
'1349432',
'1349444',
'1349450',
'1349454',
'1349504',
'1349508',
'1349516',
'1349478',
'1349530',
'1353430',
'1349582',
'1349646',
'1349618',
'1349624',
'1349644',
'1349648',
'1349668',
'1349730',
'1349680',
'1349736',
'1349700',
'1349706',
'1349720',
'1349722',
'1349776',
'1349778',
'1353446',
'1349804',
'1352482',
'1349840',
'1352484',
'1352488',
'1349846',
'1349828',
'1349914',
'1349876',
'1349898',
'1349934',
'1349948',
'1349966',
'1349968',
'1349970',
'1349986',
'1349992',
'1350016',
'1352550',
'1350082',
'1350088',
'1350094',
'1352552',
'1353488',
'1350136',
'1352574',
'1350158',
'1350166',
'1350176',
'1353468',
'1353470',
'1350208',
'1352588',
'1350218',
'1350272',
'1350308',
'1352594',
'1350336',
'1350340',
'1350346',
'1352606',
'1350430',
'1350406',
'1352608',
'1350416',
'1350422',
'1352610',
'1352624',
'1350444',
'1350446',
'1352646',
'1350448',
'1350464',
'1350466',
'1350510',
'1350520',
'1350526',
'1350544',
'1350556',
'1352712',
'1352750',
'1352764',
'1350562',
'1350566',
'1350572',
'1350582',
'1341964',
'1350604',
'1350630',
'1350636',
'1350644',
'1350656',
'1346450',
'1336620',
'1352848',
'1352852',
'1352834',
'1350762',
'1352840',
'1353976',
'1350808',
'1352864',
'1350844',
'1350850',
'1354164',
'1353530',
'1350860',
'1350864',
'1350898',
'1350876',
'1352886',
'1352896',
'1352898',
'1352906',
'1352908',
'1352910',
'1352912',
'1352928',
'1352930',
'1350902',
'1351056',
'1351032',
'1350996',
'1351014',
'1351022',
'1351048',
'1351062',
'1346542',
'1351092',
'1346612',
'1346628',
'1353658',
'1346662',
'1346706',
'1351140',
'1346724',
'1351136',
'1351196',
'1353670',
'1346896',
'1346898',
'1346900',
'1346910',
'1353700',
'1353706',
'1354172',
'1352988',
'1347068',
'1347084',
'1354026',
'1351334',
'1351346',
'1353028',
'1351366',
'1351378',
'1353740',
'1351386',
'1353038',
'1353054',
'1351394',
'1351388',
'1353738',
'1351398',
'1353062',
'1354296',
'1351426',
'1353750',
'1347240',
'1347258',
'1347266',
'1351496',
'1351500',
'1347480',
'1347502',
'1347530',
'1351518',
'1351524',
'1351560',
'1351576',
'1351588',
'1351556',
'1351558',
'1353778',
'1353780',
'1353798',
'1353806',
'1351594',
'1353116',
'1351604',
'1351714',
'1347706',
'1353136',
'1351740',
'1351750',
'1353166',
'1351768',
'1347902',
'1347882',
'1347936',
'1351806',
'1347974',
'1351892',
'1351898',
'1348180',
'1348152',
'1353184',
'1354278',
'1348252',
'1348264',
'1348334',
'1348276',
'1348280',
'1353826',
'1353846',
'1348336',
'1351982',
'1351996',
'1353232',
'1348368',
'1352012',
'1352016',
'1352018',
'1348392',
'1348394',
'1352022',
'1348420',
'1352056',
'1348436',
'1348488',
'1348500',
'1353246',
'1354102',
'1353892',
'1348710',
'1348714',
'1348768',
'1352100',
'1352102',
'1352112',
'1353908',
'1354122',
'1354256',
'1352132',
'1352188',
'1348920',
'1348928',
'1348950',
'1348964',
'1350084',
'1353346',
'1345786',
'1349166',
'1349408',
'1351636',
'1354476',
'1354472',
'1354494',
'1354546',
'1354554',
'1354566',
'1354580',
'1354660',
'1354694',
'1355094',
'1355314',
'1355408',
'1355410',
'1355740',
'1356066',
'1356110',
'1356252',
'1345002',
'1354438',

]

def run_algo():
    for app_task in TaskManager.objects.filter(task_id='PEACON', enquiry_id__in = ec_list):
        task_id = app_task.pk
        enquiry_id = TaskManager.objects.get(pk=task_id).enquiry_id.enquiry_id
        if not TaskManager.objects.filter(enquiry_id=enquiry_id, task_id='PDACON',task_completion_date = None).exists():
            TaskManager.objects.create(
                enquiry_id = CentreEnquiryRequests.objects.get(enquiry_id=enquiry_id),
                ec_sid = None,
                task_id = TaskTypes.objects.get(task_id = 'PDACON'),
                task_assigned_to = None,
                task_assigned_date = None,
                task_completion_date = None
            )

        # if not TaskManager.objects.filter(enquiry_id=enquiry_id, task_id='GRDREJ',task_completion_date = None).exists():
        #     new_task = TaskManager.objects.create(
        #         enquiry_id = CentreEnquiryRequests.objects.get(enquiry_id=enquiry_id),
        #         ec_sid = None,
        #         task_id = TaskTypes.objects.get(task_id = 'GRDREJ'),
        #         task_assigned_to = None,
        #         task_assigned_date = None,
        #         task_completion_date = None
        #     )
        #     GradeFailureAudit.objects.create(
		# 		task_key = TaskManager.objects.get(pk=new_task.pk),
		# 		failure_stage = TaskTypes.objects.get(task_id='PEACON'),
		# 		failure_reason = 'Numeric Grade Change' 
        #     )		

        #complete the task
        TaskManager.objects.filter(pk=task_id,task_id='PEACON').update(task_completion_date=timezone.now())    

run_algo()