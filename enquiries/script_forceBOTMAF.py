
import sys
import os
import django
from django.utils import timezone
import datetime

if os.getenv('DJANGO_DEVELOPMENT') == 'true':
    print('DEV')
    path = os.path.join('C:\\Users\\bulmaj\\OneDrive - Cambridge\\Desktop\\Dev\\Nova')
    sys.path.append(path)
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings_dev'
elif os.getenv('DJANGO_PRODUCTION') == 'true':
    print('PROD')
    path = os.path.join('C:\\Dev\\Nova')
    sys.path.append(path)
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings_prod'
else:
    print('UAT')
    sys.path.append('C:/Dev/redepplan')
    os.environ['DJANGO_SETTINGS_MODULE'] = 'redepplan.settings'

django.setup()

from enquiries.models import TaskManager, EnquiryComponents, CentreEnquiryRequests, ScriptApportionmentExtension, PausedEnquiry, TaskTypes, RpaFailureAudit
from django.contrib.auth.models import User

script_list = [
'1947240',
'1954224',
'1954454',
'1954452',
'1954460',
'1954462',
'1954464',
'1954466',
'1954468',
'1954470',
'1954472',
'1954474',
'1954476',
'1954488',
'1954486',
'1954494',
'1954498',
'1954496',
'1954500',
'1954508',
'1954518',
'1954520',
'1954522',
'1954526',
'1954524',
'1954538',
'1954536',
'1954534',
'1954532',
'1954540',
'1954542',
'1954544',
'1954548',
'1954550',
'1954552',
'1954556',
'1954554',
'1954560',
'1954562',
'1954564',
'1954568',
'1954570',
'1954572',
'1954574',
'1954580',
'1954582',
'1954588',
'1954586',
'1954594',
'1954592',
'1954596',
'1954598',
'1954600',
'1954602',
'1954604',
'1954606',
'1954608',
'1954610',
'1954612',
'1954616',
'1954614',
'1954618',
'1954620',
'1954622',
'1954624',
'1954626',
'1954642',
'1954638',
'1954640',
'1954646',
'1954644',
'1954650',
'1954648',
'1954654',
'1954656',
'1954660',
'1954658',
'1954662',
'1954668',
'1954666',
'1954664',
'1954678',
'1954676',
'1954680',
'1954682',
'1954692',
'1954694',
'1954696',
'1954698',
'1954702',
'1954700',
'1954710',
'1954712',
'1954714',
'1954716',
'1954718',
'1954720',
'1954722',
'1954724',
'1954726',
'1954728',
'1954736',
'1954738',
'1954742',
'1954740',
'1954744',
'1954746',
'1954750',
'1954748',
'1954752',
'1954756',
'1954754',
'1954758',
'1954766',
'1954760',
'1954762',
'1954764',
'1954768',
'1954770',
'1954772',
'1954774',
'1954804',
'1954806',
'1954808',
'1954810',
'1954812',
'1954814',
'1954816',
'1954818',
'1954820',
'1954822',
'1954824',
'1954828',
'1954826',
'1954830',
'1954838',
'1954840',
'1954842',
'1954844',
'1954846',
'1954854',
'1954852',
'1954866',
'1954868',
'1954874',
'1954878',
'1954880',
'1954882',
'1954890',
'1954900',
'1954902',
'1954904',
'1954908',
'1954906',
'1954910',
'1954912',
'1954914',
'1954918',
'1954920',
'1954924',
'1954926',
'1954928',
'1954930',
'1954932',
'1954950',
'1954948',
'1954958',
'1954960',
'1954962',
'1954972',
'1954974',
'1954976',
'1954978',
'1954982',
'1954980',
'1954984',
'1954986',
'1954988',
'1954990',
'1954996',
'1954994',
'1954998',
'1955002',
'1955004',
'1955006',
'1955010',
'1955012',
'1955014',
'1955016',
'1955020',
'1955018',
'1955022',
'1955024',
'1955066',
'1955068',
'1955074',
'1955070',
'1955072',
'1955082',
'1955080',
'1955084',
'1955086',
'1955088',
'1955094',
'1955098',
'1955096',
'1955108',
'1955110',
'1955112',
'1955114',
'1955116',
'1955118',
'1955120',
'1955124',
'1955122',
'1955134',
'1955136',
'1955142',
'1955144',
'1955146',
'1955148',
'1955152',
'1955154',
'1955156',
'1955158',
'1955162',
'1955164',
'1955166',
'1955168',
'1955170',
'1955174',
'1955176',
'1955178',
'1955180',
'1955182',
'1955184',
'1955186',
'1955188',
'1955190',
'1955192',
'1955194',
'1955200',
'1955202',
'1955204',
'1955206',
'1955208',
'1955210',
'1955212',
'1955218',
'1955216',
'1955220',
'1955222',
'1955244',
'1955246',
'1955248',
'1955250',
'1955252',
'1955254',
'1955256',
'1955258',
'1955260',
'1955264',
'1955262',
'1955270',
'1955272',
'1955278',
'1955280',
'1955292',
'1955294',
'1955296',
'1955304',
'1955306',
'1955308',
'1955310',
'1955312',
'1955316',
'1955314',
'1955318',
'1955320',
'1955322',
'1955324',
'1955330',
'1955328',
'1955326',
'1955332',
'1955336',
'1955334',
'1955344',
'1955358',
'1955360',
'1955362',
'1955364',
'1955366',
'1955368',
'1955370',
'1955372',
'1955374',
'1955384',
'1955390',
'1955394',
'1955396',
'1955398',
'1955400',
'1955414',
'1955416',
'1955418',
'1955420',
'1955422',
'1955424',
'1955426',
'1955438',
'1955440',
'1955442',
'1955444',
'1955446',
'1955448',
'1955462',
'1955460',
'1955482',
'1955480',
'1955496',
'1955500',
'1955498',
'1955518',
'1955516',
'1955520',
'1955522',
'1955524',
'1955526',
'1955528',
'1955530',
'1955532',
'1955534',
'1955536',
'1955542',
'1955540',
'1955544',
'1955546',
'1955548',
'1955550',
'1955554',
'1955564',
'1955566',
'1955568',
'1955574',
'1955572',
'1955576',
'1955578',
'1955580',
'1955582',
'1955584',
'1955588',
'1955586',
'1955592',
'1955590',
'1955596',
'1955594',
'1955600',
'1955598',
'1955602',
'1955604',
'1955612',
'1955606',
'1955610',
'1955618',
'1955616',
'1955620',
'1955622',
'1955624',
'1955628',
'1955630',
'1955638',
'1955634',
'1955636',
'1955640',
'1955642',
'1955646',
'1955644',
'1955650',
'1955648',
'1955652',
'1955654',
'1955656',
'1955658',
'1955660',
'1955668',
'1955666',
'1955662',
'1955672',
'1955670',
'1955674',
'1955678',
'1955682',
'1955684',
'1955688',
'1955686',
'1955692',
'1955690',
'1955694',
'1955696',
'1955710',
'1955712',
'1955706',
'1955724',
'1955722',
'1955726',
'1955728',
'1955732',
'1955734',
'1955736',
'1955746',
'1955748',
'1955750',
'1955752',
'1955754',
'1955756',
'1955758',
'1955760',
'1955762',
'1955764',
'1955766',
'1955768',
'1955772',
'1955770',
'1955786',
'1955792',
'1955796',
'1955794',
'1955798',
'1955800',
'1955802',
'1955804',
'1955808',
'1955806',
'1955818',
'1955820',
'1955822',
'1955826',
'1955830',
'1955832',
'1955842',
'1955844',
'1955848',
'1955846',
'1955850',
'1955852',
'1955854',
'1955856',
'1955860',
'1955858',
'1955864',
'1955862',
'1955866',
'1955868',
'1955870',
'1955872',
'1955874',
'1955878',
'1955876',
'1955908',
'1955910',
'1955916',
'1955918',
'1955920',
'1955922',
'1955924',
'1955936',
'1955938',
'1955944',
'1955948',
'1955946',
'1955952',
'1955954',
'1955960',
'1955962',
'1955964',
'1955994',
'1955996',
'1955998',
'1956000',
'1956004',
'1956002',
'1956006',
'1956010',
'1956018',
'1956020',
'1956030',
'1956034',
'1956048',
'1956052',
'1956050',
'1956058',
'1956060',
'1956062',
'1956076',
'1956078',
'1956080',
'1956082',
'1956086',
'1956084',
'1956090',
'1956088',
'1956092',
'1956110',
'1956112',
'1956118',
'1956120',
'1956122',
'1956130',
'1956132',
'1956136',
'1956134',
'1956140',
'1956138',
'1956142',
'1956148',
'1956146',
'1956152',
'1956150',
'1956154',
'1956158',
'1956156',
'1956162',
'1956160',
'1956164',
'1956170',
'1956172',
'1956174',
'1956176',
'1956178',
'1956182',
'1956180',
'1956184',
'1956186',
'1956188',
'1956192',
'1956190',
'1956194',
'1956196',
'1956198',
'1956200',
'1956202',
'1956206',
'1956204',
'1956210',
'1956208',
'1956212',
'1956214',
'1956218',
'1956216',
'1956220',
'1956224',
'1956222',
'1956226',
'1956228',
'1956230',
'1956232',
'1956240',
'1956234',
'1956236',
'1956238',
'1956258',
'1956260',
'1956262',
'1956264',
'1956266',
'1956268',
'1956272',
'1956270',
'1956286',
'1956284',
'1956292',
'1956308',
'1956310',
'1956312',
'1956314',
'1956316',
'1956318',
'1956320',
'1956322',
'1956330',
'1956334',
'1956336',
'1956340',
'1956362',
'1956360',
'1956364',
'1956418',
'1956420',
'1956424',
'1956426',
'1956430',
'1956442',
'1956444',
'1956448',
'1956450',
'1956452',
'1956458',
'1956500',
'1956510',
'1956512',
'1956520',
'1956522',
'1956524',
'1956526',
'1956528',
'1956530',
'1956534',
'1956532',
'1956538',
'1956540',
'1956542',
'1956544',
'1956546',
'1956558',
'1956570',
'1956572',
'1956568',
'1956574',
'1956576',
'1956578',
'1956580',
'1956582',
'1956584',
'1956586',
'1956590',
'1956588',
'1956592',
'1956594',
'1956596',
'1956598',
'1956600',
'1956602',
'1956626',
'1956628',
'1956630',
'1956632',
'1956636',
'1956634',
'1956640',
'1956638',
'1956642',
'1956656',
'1956654',
'1956662',
'1956664',
'1956660',
'1956658',
'1956666',
'1956668',
'1956670',
'1956672',
'1956694',
'1956752',
'1956768',
'1956770',
'1956824',
'1956822',
'1956826',
'1956828',
'1956830',
'1956832',
'1956834',
'1956840',
'1956838',
'1956844',
'1956846',
'1956850',
'1956848',
'1956872',
'1956874',
'1956880',
'1956882',
'1956890',
'1956892',
'1956906',
'1956908',
'1956910',
'1956912',
'1956924',
'1956926',
'1956928',
'1956932',
'1956930',
'1956934',
'1956938',
'1956936',
'1956940',
'1956942',
'1956946',
'1956944',
'1956948',
'1956950',
'1956952',
'1956958',
'1956956',
'1956960',
'1956962',
'1956982',
'1956986',
'1956980',
'1956984',
'1956990',
'1956992',
'1956994',
'1956996',
'1956998',
'1957002',
'1957000',
'1957004',
'1957006',
'1957012',
'1957010',
'1957014',
'1957016',
'1957020',
'1957018',
'1957022',
'1957024',
'1957026',
'1957028',
'1957030',
'1957032',
'1957038',
'1957040',
'1957054',
'1957056',
'1957060',
'1957058',
'1957062',
'1957066',
'1957068',
'1957070',
'1957072',
'1957074',
'1957076',
'1957078',
'1957082',
'1957084',
'1957086',
'1957090',
'1957092',
'1957096',
'1957094',
'1957100',
'1957098',
'1957102',
'1957108',
'1957106',
'1957112',
'1957110',
'1957116',
'1957120',
'1957122',
'1957124',
'1957132',
'1957134',
'1957136',
'1957138',
'1957140',
'1957146',
'1957148',
'1957142',
'1957152',
'1957150',
'1957154',
'1957170',
'1957184',
'1957194',
'1957196',
'1957214',
'1957234',
'1957236',
'1957238',
'1957242',
'1957240',
'1957244',
'1957246',
'1957248',
'1957250',
'1957252',
'1957254',
'1957282',
'1957280',
'1957286',
'1957288',
'1957290',
'1957292',
'1957296',
'1957298',
'1957300',
'1957302',
'1957304',
'1957306',
'1957308',
'1957310',
'1957312',
'1957314',
'1957322',
'1957328',
'1957330',
'1957332',
'1957334',
'1957336',
'1957342',
'1957340',
'1957338',
'1957344',
'1957346',
'1957348',
'1957352',
'1957350',
'1957356',
'1957354',
'1957358',
'1957362',
'1957364',
'1957366',
'1957368',
'1957372',
'1957374',
'1957376',
'1957380',
'1957378',
'1957382',
'1957384',
'1957386',
'1957388',
'1957390',
'1957394',
'1957398',
'1957400',
'1957406',
'1957408',
'1957410',
'1957412',
'1957414',
'1957418',
'1957420',
'1957422',
'1957424',
'1957426',
'1957428',
'1957430',
'1957432',
'1957434',
'1957436',
'1957438',
'1957440',
'1957442',
'1957444',
'1957446',
'1957448',
'1957452',
'1957450',
'1957454',
'1957456',
'1957458',
'1957460',
'1957462',
'1957466',
'1957464',
'1957468',
'1957470',
'1957472',
'1957474',
'1957480',
'1957484',
'1957482',
'1957490',
'1957492',
'1957500',
'1957504',
'1957502',
'1957506',
'1957508',
'1957510',
'1957512',
'1957516',
'1957518',
'1957520',
'1957522',
'1957524',
'1957526',
'1957532',
'1957534',
'1957536',
'1957548',
'1957550',
'1957552',
'1957558',
'1957556',
'1957560',
'1957562',
'1957564',
'1957566',
'1957568',
'1957570',
'1957576',
'1957578',
'1957582',
'1957580',
'1957584',
'1957586',
'1957590',
'1957588',
'1957592',
'1957598',
'1957596',
'1957600',
'1957608',
'1957610',
'1957614',
'1957618',
'1957616',
'1957612',
'1957632',
'1957634',
'1957638',
'1957636',
'1957640',
'1957642',
'1957646',
'1957648',
'1957650',
'1957652',
'1957654',
'1957656',
'1957658',
'1957664',
'1957662',
'1957668',
'1957666',
'1957670',
'1957672',
'1957682',
'1957684',
'1957686',
'1957688',
'1957690',
'1957692',
'1957696',
'1957700',
'1957698',
'1957710',
'1957712',
'1957714',
'1957716',
'1957718',
'1957720',
'1957728',
'1957722',
'1957724',
'1957726',
'1957730',
'1957732',
'1957734',
'1957746',
'1957750',
'1957748',
'1957752',
'1957754',
'1957756',
'1957758',
'1957760',
'1957762',
'1957768',
'1957770',
'1957774',
'1957772',
'1957782',
'1957780',
'1957784',
'1957788',
'1957786',
'1957790',
'1957792',
'1957794',
'1957796',
'1957800',
'1957798',
'1957804',
'1957802',
'1957808',
'1957806',
'1957814',
'1957812',
'1957810',
'1957818',
'1957820',
'1957826',
'1957824',
'1957828',
'1957832',
'1957838',
'1957840',
'1957842',
'1957848',
'1957846',
'1957850',

    ]

for script_id in script_list:

		if not TaskManager.objects.filter(ec_sid=EnquiryComponents.objects.only('ec_sid').get(ec_sid=script_id), task_id='BOTAPF',task_completion_date = None).exists():
			this_task = TaskManager.objects.create(
				enquiry_id = CentreEnquiryRequests.objects.get(enquiries__enquiry_parts__ec_sid=script_id),
				ec_sid = EnquiryComponents.objects.get(ec_sid=script_id),
				task_id = TaskTypes.objects.get(task_id = 'BOTAPF'),
				task_assigned_to = None,
				task_assigned_date = None,
				task_completion_date = None
			)
			this_task.refresh_from_db()
			print(this_task.pk)
			RpaFailureAudit.objects.create(
				rpa_task_key = TaskManager.objects.get(pk=this_task.pk),
				failure_reason = 'Bot run failure'
			)
		#complete the task
		TaskManager.objects.filter(ec_sid=script_id,task_id='BOTAPP').update(task_completion_date=timezone.now())